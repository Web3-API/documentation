"use strict";(self.webpackChunk_polywrap_docs=self.webpackChunk_polywrap_docs||[]).push([[8036],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>f});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),c=p(n),m=r,f=c["".concat(s,".").concat(m)]||c[m]||d[m]||o;return n?a.createElement(f,l(l({ref:t},u),{},{components:n})):a.createElement(f,l({ref:t},u))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,l=new Array(o);l[0]=m;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[c]="string"==typeof e?e:r,l[1]=i;for(var p=2;p<o;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},5162:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(7294),r=n(6010);const o={tabItem:"tabItem_Ymn6"};function l(e){let{children:t,hidden:n,className:l}=e;return a.createElement("div",{role:"tabpanel",className:(0,r.Z)(o.tabItem,l),hidden:n},t)}},4866:(e,t,n)=>{n.d(t,{Z:()=>k});var a=n(7462),r=n(7294),o=n(6010),l=n(2466),i=n(6550),s=n(1980),p=n(7392),u=n(12);function c(e){return function(e){return r.Children.map(e,(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:r}}=e;return{value:t,label:n,attributes:a,default:r}}))}function d(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??c(n);return function(e){const t=(0,p.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function m(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function f(e){let{queryString:t=!1,groupId:n}=e;const a=(0,i.k6)(),o=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,s._X)(o),(0,r.useCallback)((e=>{if(!o)return;const t=new URLSearchParams(a.location.search);t.set(o,e),a.replace({...a.location,search:t.toString()})}),[o,a])]}function y(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,o=d(e),[l,i]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:o}))),[s,p]=f({queryString:n,groupId:a}),[c,y]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,o]=(0,u.Nk)(n);return[a,(0,r.useCallback)((e=>{n&&o.set(e)}),[n,o])]}({groupId:a}),h=(()=>{const e=s??c;return m({value:e,tabValues:o})?e:null})();(0,r.useLayoutEffect)((()=>{h&&i(h)}),[h]);return{selectedValue:l,selectValue:(0,r.useCallback)((e=>{if(!m({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);i(e),p(e),y(e)}),[p,y,o]),tabValues:o}}var h=n(2389);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function g(e){let{className:t,block:n,selectedValue:i,selectValue:s,tabValues:p}=e;const u=[],{blockElementScrollPositionUntilNextRender:c}=(0,l.o5)(),d=e=>{const t=e.currentTarget,n=u.indexOf(t),a=p[n].value;a!==i&&(c(t),s(a))},m=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const n=u.indexOf(e.currentTarget)+1;t=u[n]??u[0];break}case"ArrowLeft":{const n=u.indexOf(e.currentTarget)-1;t=u[n]??u[u.length-1];break}}t?.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":n},t)},p.map((e=>{let{value:t,label:n,attributes:l}=e;return r.createElement("li",(0,a.Z)({role:"tab",tabIndex:i===t?0:-1,"aria-selected":i===t,key:t,ref:e=>u.push(e),onKeyDown:m,onClick:d},l,{className:(0,o.Z)("tabs__item",b.tabItem,l?.className,{"tabs__item--active":i===t})}),n??t)})))}function v(e){let{lazy:t,children:n,selectedValue:a}=e;const o=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=o.find((e=>e.props.value===a));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},o.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==a}))))}function w(e){const t=y(e);return r.createElement("div",{className:(0,o.Z)("tabs-container",b.tabList)},r.createElement(g,(0,a.Z)({},e,t)),r.createElement(v,(0,a.Z)({},e,t)))}function k(e){const t=(0,h.Z)();return r.createElement(w,(0,a.Z)({key:String(t)},e))}},5027:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>s,default:()=>f,frontMatter:()=>i,metadata:()=>p,toc:()=>c});var a=n(7462),r=(n(7294),n(3905)),o=n(4866),l=n(5162);const i={id:"deploy-pipeline",title:"Configure Polywrap deployment pipeline"},s=void 0,p={unversionedId:"tutorials/build-and-deploy-wasm-wrappers/deploy-pipeline",id:"tutorials/build-and-deploy-wasm-wrappers/deploy-pipeline",title:"Configure Polywrap deployment pipeline",description:"Polywrap makes it easy to create an automated wrapper deployment pipeline using a Deploy Manifest polywrap.deploy.yaml file and the Polywrap CLI's deploy command.",source:"@site/docs/tutorials/build-and-deploy-wasm-wrappers/deploy-pipeline.md",sourceDirName:"tutorials/build-and-deploy-wasm-wrappers",slug:"/tutorials/build-and-deploy-wasm-wrappers/deploy-pipeline",permalink:"/tutorials/build-and-deploy-wasm-wrappers/deploy-pipeline",draft:!1,editUrl:"https://github.com/polywrap/documentation/tree/main/src/docs/tutorials/build-and-deploy-wasm-wrappers/deploy-pipeline.md",tags:[],version:"current",frontMatter:{id:"deploy-pipeline",title:"Configure Polywrap deployment pipeline"},sidebar:"docs",previous:{title:"Publish to ENS",permalink:"/tutorials/build-and-deploy-wasm-wrappers/publish-to-ens"},next:{title:"Plugin an existing JS SDK",permalink:"/tutorials/create-plugin-wrappers/create-js-plugin"}},u={},c=[{value:"Declaration",id:"declaration",level:2},{value:"Content",id:"content",level:2},{value:"Deployment Modules",id:"deployment-modules",level:2},{value:"IPFS",id:"ipfs",level:3},{value:"ENS",id:"ens",level:3},{value:"Local Dev ENS",id:"local-dev-ens",level:3}],d={toc:c},m="wrapper";function f(e){let{components:t,...n}=e;return(0,r.kt)(m,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Polywrap makes it easy to create an automated wrapper deployment pipeline using a Deploy Manifest ",(0,r.kt)("inlineCode",{parentName:"p"},"polywrap.deploy.yaml")," file and the Polywrap CLI's ",(0,r.kt)("a",{parentName:"p",href:"../../reference/cli/commands/deploy"},(0,r.kt)("inlineCode",{parentName:"a"},"deploy"))," command.\nThis section helps you configure a Deploy Manifest, which defines the stages of your deployment pipeline.\nOnce you've configured the manifest, you can use the Polywrap CLI's ",(0,r.kt)("a",{parentName:"p",href:"../../reference/cli/commands/deploy"},(0,r.kt)("inlineCode",{parentName:"a"},"deploy"))," command to execute the pipeline."),(0,r.kt)("h2",{id:"declaration"},"Declaration"),(0,r.kt)("p",null,"The location of the deployment manifest should be declared in your Polywrap Manifest ",(0,r.kt)("inlineCode",{parentName:"p"},"polywrap.yaml")," with a field labeled ",(0,r.kt)("em",{parentName:"p"},"deploy"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"deploy: ./polywrap.deploy.yaml\n")),(0,r.kt)("h2",{id:"content"},"Content"),(0,r.kt)("p",null,"The concents of a Deploy Manifest consists of one or more jobs with their steps, each of which has some common fields and a set of configuration options particular to the step's module. All jobs run in parallel, while steps of each job run in series."),(0,r.kt)("p",null,"The result of a step can be passed as input to a later step using ",(0,r.kt)("inlineCode",{parentName:"p"},"$$step_name"),"."),(0,r.kt)(o.Z,{defaultValue:"schema",values:[{label:"Schema",value:"schema"},{label:"Example",value:"example"}],mdxType:"Tabs"},(0,r.kt)(l.Z,{value:"schema",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"format: # The manifest format version\njobs: # Each job describes series of events in the pipeline\n  [name]: # Name of the job\n    config: # configuration for all deployment modules, can be overridden within each step\n    steps: # Each step describes an event in the pipeline\n      - name: # The name of the step\n        package: # Deployment module\n        uri: # The wrap URI of source content\n        depends_on: # (Optional) Use prior step's output\n        config: # Configuration for the deployment module\n"))),(0,r.kt)(l.Z,{value:"example",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"format: 0.2.0\njobs:\n  ipfs_deploy:\n    config:\n      gatewayUri: 'ipfs.wrappers.io'\n    steps:\n      - name: ipfs_deploy\n        package: ipfs\n        uri: fs/./build\n        config:\n          gatewayUri: ipfs.wrappers.io\n      - name: ens_deploy\n        package: ens\n        uri: $$ipfs_deploy\n        config:\n          domainName: uniswapv3.eth\n          provider: https://rinkeby.infura.io/v3/d119148113c047ca90f0311ed729c467\n          ensRegistryAddress: \"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e\"\n          privateKey: 0xNeverShareYourPrivateKey\n")))),(0,r.kt)("h2",{id:"deployment-modules"},"Deployment Modules"),(0,r.kt)("p",null,"Polywrap currently supports three types of deployment modules: "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"ipfs"),": pins a folder's contents to IPFS and returns the content hash (CID)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"ens"),": points an ENS domain to an IPFS content hash"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"local-dev-ens"),": registers a domain on a local test environment and points the domain to an IPFS content hash")),(0,r.kt)("h3",{id:"ipfs"},"IPFS"),(0,r.kt)("p",null,"The IPFS module pins a folder's contents to IPFS and returns the content hash (CID).\nIt can be used to deploy a wrapper by ",(0,r.kt)("a",{parentName:"p",href:"https://docs.ipfs.io/how-to/pin-files/"},"pinning")," the contents of your project's build folder to the IPFS network. "),(0,r.kt)("p",null,"The IPFS module's custom configuration requires an IPFS gateway URI so the CLI knows where to send the files."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="Example: ipfs configuration"',title:'"Example:',ipfs:!0,'configuration"':!0},"config:\n  gatewayUri: 'ipfs.wrappers.io' # IPFS gateway URI\n")),(0,r.kt)("h3",{id:"ens"},"ENS"),(0,r.kt)("p",null,"The ENS module accepts an IPFS content hash (CID) as input and points an ENS domain name to it."),(0,r.kt)("p",null,"The ENS module's custom configuration requires three arguments and accepts an optional fourth:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"domainName: the ENS domain name owned by your Ethereum account"),(0,r.kt)("li",{parentName:"ul"},"provider: an Ethereum JSON RPC provider"),(0,r.kt)("li",{parentName:"ul"},"ensRegistryAddress: the Ethereum address of the ENS Registry smart contract"),(0,r.kt)("li",{parentName:"ul"},"privateKey: (optional) your Ethereum account's private key, used when the Ethereum provider cannot produce an account signer")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="Example: ens configuration"',title:'"Example:',ens:!0,'configuration"':!0},"config:\n  domainName: 'wrapper.eth' # ENS domain name\n  provider: 'http://localhost:4545' # an Ethereum JSON RPC provider URI\n  ensRegistryAddress: '0x...' # The ENS Registry contract address\n  privateKey: '' # a private key may be required to sign ethereum transactions\n")),(0,r.kt)("h3",{id:"local-dev-ens"},"Local Dev ENS"),(0,r.kt)("p",null,"The Local Dev ENS module accepts an IPFS content hash (CID) as input, registers an ENS domain name, and points the domain name to the IPFS CID."),(0,r.kt)("p",null,"The Local Dev ENS module was created with Polywrap's default test environment infrastructure in mind. "),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Polywrap's default test environment can be started with the ",(0,r.kt)("inlineCode",{parentName:"p"},"polywrap infra up")," CLI command and stopped with the ",(0,r.kt)("inlineCode",{parentName:"p"},"polywrap infra down")," CLI command.")),(0,r.kt)("p",null,"The module assumes ENS infrastructure is set up on a local Ethereum network with the ENS smart contracts deployed at the following addresses:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"ENS Registry: 0xe78A0F7E598Cc8b0Bb87894B0F60dD2a88d6a8Ab"),(0,r.kt)("li",{parentName:"ul"},"ENS Resolver: 0x5b1869D9A4C187F2EAa108f3062412ecf0526b24"),(0,r.kt)("li",{parentName:"ul"},"ENS Registrar: 0xD833215cBcc3f914bD1C9ece3EE7BF8B14f841bb"),(0,r.kt)("li",{parentName:"ul"},"ENS Reverse Lookup: 0xe982E462b094850F12AF94d21D470e21bE9D0E9C")),(0,r.kt)("p",null,"The Local Dev ENS module's custom configuration requires two arguments:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"domainName: the desired ENS domain name to be registered"),(0,r.kt)("li",{parentName:"ul"},"ports: contains the port of the local Ethereum test network")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="Example: local-dev-ens configuration"',title:'"Example:',"local-dev-ens":!0,'configuration"':!0},"config:\n  domainName: 'wrapper.eth' # ENS domain name\n  ports:\n    ethereum: 4545\n")))}f.isMDXComponent=!0}}]);