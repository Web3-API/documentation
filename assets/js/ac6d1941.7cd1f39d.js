"use strict";(self.webpackChunk_polywrap_docs=self.webpackChunk_polywrap_docs||[]).push([[2585],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>d});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var i=r.createContext({}),s=function(e){var t=r.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):p(p({},t),e)),n},u=function(e){var t=s(e.components);return r.createElement(i.Provider,{value:t},e.children)},m="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},c=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,l=e.originalType,i=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),m=s(n),c=a,d=m["".concat(i,".").concat(c)]||m[c]||h[c]||l;return n?r.createElement(d,p(p({ref:t},u),{},{components:n})):r.createElement(d,p({ref:t},u))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=n.length,p=new Array(l);p[0]=c;var o={};for(var i in t)hasOwnProperty.call(t,i)&&(o[i]=t[i]);o.originalType=e,o[m]="string"==typeof e?e:a,p[1]=o;for(var s=2;s<l;s++)p[s]=n[s];return r.createElement.apply(null,p)}return r.createElement.apply(null,n)}c.displayName="MDXCreateElement"},6770:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>p,default:()=>h,frontMatter:()=>l,metadata:()=>o,toc:()=>s});var r=n(7462),a=(n(7294),n(3905));const l={id:"default-plugins",title:"Default plugins"},p=void 0,o={unversionedId:"tutorials/create-wasm-wrappers/default-plugins",id:"tutorials/create-wasm-wrappers/default-plugins",title:"Default plugins",description:"Polywrap plugin wrappers extend the capabilities of Wasm wrappers. Some plugin wrappers come included in the Polywrap client by default:",source:"@site/docs/tutorials/create-wasm-wrappers/default-plugins.md",sourceDirName:"tutorials/create-wasm-wrappers",slug:"/tutorials/create-wasm-wrappers/default-plugins",permalink:"/tutorials/create-wasm-wrappers/default-plugins",draft:!1,editUrl:"https://github.com/polywrap/documentation/tree/main/src/docs/tutorials/create-wasm-wrappers/default-plugins.md",tags:[],version:"current",frontMatter:{id:"default-plugins",title:"Default plugins"},sidebar:"docs",previous:{title:"Configure a Polywrap Manifest",permalink:"/tutorials/create-wasm-wrappers/polywrap-manifest"},next:{title:"Add Metadata",permalink:"/tutorials/create-wasm-wrappers/add-metadata"}},i={},s=[{value:"Import to schema",id:"import-to-schema",level:2},{value:"Use in Wasm Wrapper",id:"use-in-wasm-wrapper",level:2},{value:"Commonly used default plugins",id:"commonly-used-default-plugins",level:2},{value:"Ethereum",id:"ethereum",level:3},{value:"Subgraph",id:"subgraph",level:3},{value:"Example Implementation:",id:"example-implementation",level:4},{value:"HTTP",id:"http",level:3},{value:"Example Implementation",id:"example-implementation-1",level:4},{value:"Logger",id:"logger",level:3}],u={toc:s},m="wrapper";function h(e){let{components:t,...n}=e;return(0,a.kt)(m,(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Polywrap plugin wrappers extend the capabilities of Wasm wrappers. Some plugin wrappers come included in the Polywrap client by default:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"ENS Resolver"),(0,a.kt)("li",{parentName:"ul"},"Ethereum"),(0,a.kt)("li",{parentName:"ul"},"Filesystem"),(0,a.kt)("li",{parentName:"ul"},"Filesystem Resolver"),(0,a.kt)("li",{parentName:"ul"},"Graph-node"),(0,a.kt)("li",{parentName:"ul"},"HTTP"),(0,a.kt)("li",{parentName:"ul"},"IPFS"),(0,a.kt)("li",{parentName:"ul"},"IPFS Resolver"),(0,a.kt)("li",{parentName:"ul"},"Logger"),(0,a.kt)("li",{parentName:"ul"},"SHA3"),(0,a.kt)("li",{parentName:"ul"},"UTS-46")),(0,a.kt)("p",null,"In this guide, we'll show you what it's like to import these default plugins into your wrapper, and explain what some commonly used plugins do."),(0,a.kt)("h2",{id:"import-to-schema"},"Import to schema"),(0,a.kt)("p",null,"We'll use one of the default plugins, Ethereum, to show how you can import its modules into your wrapper's schema (",(0,a.kt)("inlineCode",{parentName:"p"},"schema.graphql")," file)."),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},'#import { Module, Connection } into Ethereum from "wrap://ens/ethereum.polywrap.eth"')),(0,a.kt)("p",null,"Below, we explain what each part of this code means."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("inlineCode",{parentName:"p"},"#import")),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Imports specific modules from a deployed or local plugin"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("inlineCode",{parentName:"p"},"{ Module, Connection }")),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"These are specific modules that we're unpacking from the one of Polywrap's default plugins, Ethereum."))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("inlineCode",{parentName:"p"},"into Ethereum")),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"This is a namespace, enabling you to use the modules in your schema e.g. ",(0,a.kt)("inlineCode",{parentName:"li"},"Ethereum_Module")," or ",(0,a.kt)("inlineCode",{parentName:"li"},"Ethereum_Connection")))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("inlineCode",{parentName:"p"},'from "wrap://ens/ethereum.polywrap.eth"')),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"wrap://")," is the Polywrap URI schema."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"ens")," is the URI authority. It tells the Polywrap client what kind of URI it needs to resolve. The ",(0,a.kt)("inlineCode",{parentName:"li"},"ens")," authority tells the Polywrap client that what follows is an ENS address that resolves to a decentralized storage hosting a wrapper. Other valid authorities include ",(0,a.kt)("inlineCode",{parentName:"li"},"ipfs")," for IPFS content hashes, ",(0,a.kt)("inlineCode",{parentName:"li"},"fs")," for wrappers located on your local filesystem (often used while testing wrappers), or a custom authority that may be handled by a custom URI resolver."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"ethereum.polywrap.eth")," is the URI path, which in this case is an ENS address."),(0,a.kt)("li",{parentName:"ul"},"Note: The client redirects queries from the URI of a plugin wrapper to the plugin object that exists in memory. While plugins typically use an ENS URI for readability, the client does not need to query the ENS registry or an external storage location. See our section on ",(0,a.kt)("a",{parentName:"li",href:"/tutorials/understanding-uri-redirects"},"URI redirects")," for more information.")))),(0,a.kt)("h2",{id:"use-in-wasm-wrapper"},"Use in Wasm Wrapper"),(0,a.kt)("p",null,"Once types have been imported, the functionality of these imported modules can be used in wrapper development."),(0,a.kt)("p",null,"Upon ",(0,a.kt)("inlineCode",{parentName:"p"},"yarn build"),", the imported types and modules will be made available to you in the ",(0,a.kt)("inlineCode",{parentName:"p"},"src/wrap")," folder.  To use them, you simply need to import the specific modules that you'd like to use."),(0,a.kt)("p",null,"If you're building an AssemblyScript-based wrapper, the import might look like this:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},"import { Ethereum_Module, Ethereum_Connection } from './wrap';\n")),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"Ethereum_Module")," will contain the methods shown ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/polywrap/monorepo/blob/255caa0a40130f0733a31ac28efed272bfa00889/packages/js/plugins/ethereum/src/schema.graphql#L104"},"here"),", under the ",(0,a.kt)("inlineCode",{parentName:"p"},"Module")," type."),(0,a.kt)("p",null,"Once imported, you can access methods like so:"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"Ethereum_Module.callContractMethod({ ... })")),(0,a.kt)("h2",{id:"commonly-used-default-plugins"},"Commonly used default plugins"),(0,a.kt)("p",null,"This section contains guides on commonly used default plugins: Ethereum, Subgraph, HTTP, and Logger."),(0,a.kt)("h3",{id:"ethereum"},"Ethereum"),(0,a.kt)("p",null,"The Ethereum plugin enables wrappers to query the ethereum blockchain."),(0,a.kt)("p",null,"Schema: ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/polywrap/monorepo/blob/prealpha/packages/js/plugins/ethereum/src/schema.graphql"},"Link")),(0,a.kt)("p",null,"Example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},"export function getData(input: Input_getData): u32 {\n  const res = Ethereum_Module.callContractView({\n    address: input.address,\n    method: 'function get() view returns (uint256)',\n    args: null,\n    connection: input.connection,\n  }).unwrap();\n\n  return U32.parseInt(res);\n}\n")),(0,a.kt)("h3",{id:"subgraph"},"Subgraph"),(0,a.kt)("p",null,"The subgraph plugin enables wrappers to query The Graph's subgraphs."),(0,a.kt)("p",null,"Schema: ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/polywrap/monorepo/blob/2947f956485decb43363f42c99c2a6176a25bde8/packages/js/plugins/graph-node/schema.graphql#L3-L9"},"Link")),(0,a.kt)("h4",{id:"example-implementation"},"Example Implementation:"),(0,a.kt)("p",null,"In our ",(0,a.kt)("inlineCode",{parentName:"p"},"./src/schema.graphql")," file, we'll write the schema for our wrapper."),(0,a.kt)("p",null,"At the top of this file, import the GraphNode module into your wrapper:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-graphql"},'#import { Module } into GraphNode from "wrap://ens/graph-node.polywrap.eth"\n')),(0,a.kt)("p",null,"Then, define the types and fields on the ",(0,a.kt)("inlineCode",{parentName:"p"},"querySubgraph")," method."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-graphql"},"  querySubgraph(\n    subgraphAuthor: String!\n    subgraphName: String!\n    query: String!\n  ): JSON!\n")),(0,a.kt)("p",null,"We'll now implement the ",(0,a.kt)("inlineCode",{parentName:"p"},"querySubgraph")," method in AssemblyScript."),(0,a.kt)("p",null,"At the top of ",(0,a.kt)("inlineCode",{parentName:"p"},"index.ts"),", include these import statements:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},"import { GraphNode_Module, Args_querySubgraph } from './wrap';\nimport { JSON } from '@polywrap/wasm-as';\n")),(0,a.kt)("p",null,"Then, implement the ",(0,a.kt)("inlineCode",{parentName:"p"},"querySubgraph")," method:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},"export function querySubgraph(args: Args_querySubgraph): JSON.Value {\n  const response = GraphNode_Module.querySubgraph({\n    subgraphAuthor: args.subgraphAuthor,\n    subgraphName: args.subgraphName,\n    query: args.query,\n  }).unwrap();\n\n  const json = JSON.parse(response);\n  const obj = json as JSON.Obj;\n  return obj.valueOf().get('data') as JSON.Value;\n}\n")),(0,a.kt)("p",null,"Example query to test your method:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},"subgraphAuthor: 'ensdomains',\nsubgraphName: 'ens',\nquery: '{\\ndomains(first: 5){\\nid\\nname\\nlabelName\\nlabelhash\\n}\\n}',\n")),(0,a.kt)("h3",{id:"http"},"HTTP"),(0,a.kt)("p",null,"The HTTP plugin enables wrappers to perform HTTP queries in JavaScript applications."),(0,a.kt)("p",null,"Schema: ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/polywrap/monorepo/blob/2947f956485decb43363f42c99c2a6176a25bde8/packages/js/plugins/http/schema.graphql#L30-L33"},"Link")),(0,a.kt)("h4",{id:"example-implementation-1"},"Example Implementation"),(0,a.kt)("p",null,"In this example, we will implement a simple ",(0,a.kt)("inlineCode",{parentName:"p"},"Ping")," method which pings CoinGecko to see their server status using an HTTP Get request from your wrapper."),(0,a.kt)("p",null,"In our ",(0,a.kt)("inlineCode",{parentName:"p"},"./src/schema.graphql file"),", we\u2019ll write the schema for our wrapper."),(0,a.kt)("p",null,"At the top of this file, import the HTTP module into your wrapper:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-graphql"},'#import { Module, Request, Response } into HTTP from "wrap://ens/http.polywrap.eth"\n')),(0,a.kt)("p",null,"Then, define the types and fields on the ",(0,a.kt)("inlineCode",{parentName:"p"},"Ping")," method.  First, add a new ",(0,a.kt)("inlineCode",{parentName:"p"},"Ping")," type at the bottom of the schema."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-graphql"},"type Ping {\n  gecko_says: String!\n}\n")),(0,a.kt)("p",null,"Then, add an argument-less method called ",(0,a.kt)("inlineCode",{parentName:"p"},"ping")," that returns a non-nullable ",(0,a.kt)("inlineCode",{parentName:"p"},"Ping")," to the ",(0,a.kt)("inlineCode",{parentName:"p"},"Module")," type.\nOur completed schema looks like this:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-graphql"},'#import { Module, Request, Response } into HTTP from "wrap://ens/http.polywrap.eth"\ntype Module {\n  ping: Ping!\n}\n\ntype Ping {\n  gecko_says: String!\n}\n')),(0,a.kt)("p",null,"Now, we'll implement the ",(0,a.kt)("inlineCode",{parentName:"p"},"ping")," method in ",(0,a.kt)("inlineCode",{parentName:"p"},"./src/index.ts")),(0,a.kt)("p",null,"At the top of the file, we'll import the HTTP/Ping methods and types."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript="},"import {\n  HTTP_Module,\n  HTTP_ResponseType,\n  Ping,\n} from './wrap';\n")),(0,a.kt)("p",null,"Then, implement Ping function:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},"export function ping(): Ping {\n    \n  // Writing the HTTP request / response\n  const response = HTTP_Module.get({\n    url: 'https://api.coingecko.com/api/v3/ping',\n    request: {\n      headers: [],\n      urlParams: [],\n      body: '',\n      responseType: HTTP_ResponseType.TEXT,\n    },\n  }).unwrap();\n    \n  // Error handling for the response\n  if (!response || response.status !== 200 || !response.body) {\n    const errorMsg =\n      response && response.statusText\n        ? (response.statusText as string)\n        : 'An error occurred while fetching data from Coingecko API';\n    throw new Error(errorMsg);\n  }  \n    \n  const json = <JSON.Obj>JSON.parse(response.body);\n    \n // Response from Coingecko with field `geckoSays`\n  const geckoSays = json.getString('gecko_says');\n  if (geckoSays) {\n    return {\n      gecko_says: geckoSays.valueOf(),\n    };\n  }\n  throw new Error('Invalid response body!');\n}\n")),(0,a.kt)("h3",{id:"logger"},"Logger"),(0,a.kt)("p",null,"The Logger plugin enables logging in a Wasm wrapper, which can be useful for debugging."),(0,a.kt)("p",null,"In our ",(0,a.kt)("inlineCode",{parentName:"p"},"./src/schema.graphql file"),", import the Logger module into your wrapper:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-graphql"},'#import { Module } into Logger from "wrap://ens/js-logger.polywrap.eth"\n')),(0,a.kt)("p",null,"Then in your implementation file ",(0,a.kt)("inlineCode",{parentName:"p"},"./src/index.ts"),", import the Logger function:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},"import {\n  Logger_Module,\n  Logger_Logger_LogLevel,\n} from './wrap';\n")),(0,a.kt)("p",null,"And use it like so:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"}," Logger_Module.log({\n    level: Logger_Logger_LogLevel.INFO,\n    message: `Insert useful log message here`,\n  });\n")),(0,a.kt)("p",null,"When you run your test e.g. ",(0,a.kt)("inlineCode",{parentName:"p"},"yarn test:e2e"),", you will see the logged message in the console."))}h.isMDXComponent=!0}}]);