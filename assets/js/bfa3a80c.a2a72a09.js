"use strict";(self.webpackChunk_polywrap_docs=self.webpackChunk_polywrap_docs||[]).push([[5953],{3905:(t,e,r)=>{r.d(e,{Zo:()=>c,kt:()=>f});var n=r(7294);function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){a(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function l(t,e){if(null==t)return{};var r,n,a=function(t,e){if(null==t)return{};var r,n,a={},o=Object.keys(t);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||(a[r]=t[r]);return a}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}var s=n.createContext({}),p=function(t){var e=n.useContext(s),r=e;return t&&(r="function"==typeof t?t(e):i(i({},e),t)),r},c=function(t){var e=p(t.components);return n.createElement(s.Provider,{value:e},t.children)},u="mdxType",w={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},d=n.forwardRef((function(t,e){var r=t.components,a=t.mdxType,o=t.originalType,s=t.parentName,c=l(t,["components","mdxType","originalType","parentName"]),u=p(r),d=a,f=u["".concat(s,".").concat(d)]||u[d]||w[d]||o;return r?n.createElement(f,i(i({ref:e},c),{},{components:r})):n.createElement(f,i({ref:e},c))}));function f(t,e){var r=arguments,a=e&&e.mdxType;if("string"==typeof t||a){var o=r.length,i=new Array(o);i[0]=d;var l={};for(var s in e)hasOwnProperty.call(e,s)&&(l[s]=e[s]);l.originalType=t,l[u]="string"==typeof t?t:a,i[1]=l;for(var p=2;p<o;p++)i[p]=r[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},6285:(t,e,r)=>{r.r(e),r.d(e,{assets:()=>s,contentTitle:()=>i,default:()=>w,frontMatter:()=>o,metadata:()=>l,toc:()=>p});var n=r(7462),a=(r(7294),r(3905));const o={id:"writing-tests-with-workflows",title:"Writing tests with workflows"},i=void 0,l={unversionedId:"tutorials/create-wraps/tutorial/writing-tests-with-workflows",id:"tutorials/create-wraps/tutorial/writing-tests-with-workflows",title:"Writing tests with workflows",description:"Testing",source:"@site/docs/tutorials/create-wraps/tutorial/writing-tests-with-workflows.md",sourceDirName:"tutorials/create-wraps/tutorial",slug:"/tutorials/create-wraps/tutorial/writing-tests-with-workflows",permalink:"/tutorials/create-wraps/tutorial/writing-tests-with-workflows",draft:!1,editUrl:"https://github.com/polywrap/documentation/tree/main/src/docs/tutorials/create-wraps/tutorial/writing-tests-with-workflows.md",tags:[],version:"current",frontMatter:{id:"writing-tests-with-workflows",title:"Writing tests with workflows"},sidebar:"docs",previous:{title:"Adding new Methods",permalink:"/tutorials/create-wraps/tutorial/adding-new-methods"},next:{title:"Deploy locally & run tests",permalink:"/tutorials/create-wraps/tutorial/deploy-locally-and-test"}},s={},p=[{value:"<strong>Testing</strong>",id:"testing",level:3}],c={toc:p},u="wrapper";function w(t){let{components:e,...r}=t;return(0,a.kt)(u,(0,n.Z)({},c,r,{components:e,mdxType:"MDXLayout"}),(0,a.kt)("h3",{id:"testing"},(0,a.kt)("strong",{parentName:"h3"},"Testing")),(0,a.kt)("p",null,"In order to test this new functionality, we'll update the existing ",(0,a.kt)("inlineCode",{parentName:"p"},"./workflows/e2e.yaml")," workflow file to include the new methods we've added (",(0,a.kt)("inlineCode",{parentName:"p"},"setIpfsData"),", and ",(0,a.kt)("inlineCode",{parentName:"p"},"getIpfsData"),")."),(0,a.kt)("p",null,"Add the following case to the ",(0,a.kt)("inlineCode",{parentName:"p"},"e2e.yaml")," workflow in the ",(0,a.kt)("inlineCode",{parentName:"p"},"./workflows")," folder."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="./workflows/e2e.yaml"',title:'"./workflows/e2e.yaml"'},'      case2:\n        steps:\n          - uri: fs/build\n            method: setIpfsData\n            args:\n              options:\n                address: "$cases.0.data"\n                data: "Hello from IPFS!"\n              ipfsProvider: "http://localhost:5001"\n          - uri: fs/build\n            method: getIpfsData\n            args:\n              address: "$cases.0.data"\n              ipfsProvider: "http://localhost:5001"\n')),(0,a.kt)("p",null,"Once our workflow has been defined, we may want to be able to validate our actual results against our expectations.\nWorkflow validation uses ",(0,a.kt)("a",{parentName:"p",href:"https://cuelang.org/"},"CUE"),", a flexible and expressive data validation language.\nCUE must be installed to complete this step. "),(0,a.kt)("p",null,"If you don't want to install anything right now, don't worry!\nOur results will be easy to verify with manually."),(0,a.kt)("p",null,"To continue with automated testing, let's add our expected output to a new file in the workflows folder. We will call\nthe file ",(0,a.kt)("inlineCode",{parentName:"p"},"validator.cue"),"."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cue",metastring:'title="./workflows/validator.cue"',title:'"./workflows/validator.cue"'},'package e2e\n\ncases: {\n  $0: {\n    data: =~"^0x[A-Fa-f0-9]{40}$",\n    error?: _|_, // Never fails\n  }\n  case1: {\n    $0: {\n      data: =~"^0x[A-Fa-f0-9]{64}$",\n      error?: _|_,\n    }\n    $1: {\n      data: uint,\n      error?: _|_\n    }\n  }\n  case2: {\n    $0: {\n      data: {\n        txReceipt: string,\n        ipfsHash: "QmPhAJz5QbidN3LgT2eDiu6Z3nCFs2gYQMbjgEAncrGsis"\n        },\n      error?: _|_,\n      }\n    $1: {\n      data: "Hello from IPFS!",\n      error?: _|_,\n    }\n  }\n}\n')),(0,a.kt)("p",null,"With our workflow complete, we'll deploy and test our wrap locally in the next section!"))}w.isMDXComponent=!0}}]);